<script>
function calcularRiscoAVC() {
    // 1. CAPTURAR OS DADOS DO FORMULÁRIO HTML
    var age = parseFloat(document.getElementById('age').value);
    var avg_glucose_level = parseFloat(document.getElementById('glucose').value);
    var bmi = parseFloat(document.getElementById('bmi').value);
    
    // Checkboxes
    var hypertension = document.getElementById('hypertension').checked ? 1 : 0;
    var heart_disease = document.getElementById('heart_disease').checked ? 1 : 0;
    
    // Selects
    var smoking_status = document.getElementById('smoking_status').value; 

    // --- 2. COEFICIENTES DO MODELO R ---
    var intercept = -6.998;
    var b_age = 0.07721;
    var b_hypertension = 0.5791;
    var b_heart_disease = 0.3002;
    var b_glucose = 0.004723;
    var b_bmi = 0.01608;
    
    // Coeficientes Fumo
    var b_smoke_never = -0.0419; 
    var b_smoke_smokes = 0.208; 

    // --- 3. CAMPOS OCULTOS (Médias fixas) ---
    var b_gender_male = 0.075; 
    var b_married_yes = -0.093; 
    var b_urban = -0.008;       
    var b_work_private = -1.48; 

    // --- 4. CÁLCULO (Log-Odds) ---
    var log_odds = intercept 
                 + (age * b_age)
                 + (hypertension * b_hypertension)
                 + (heart_disease * b_heart_disease)
                 + (avg_glucose_level * b_glucose)
                 + (bmi * b_bmi)
                 + b_gender_male 
                 + b_married_yes
                 + b_urban
                 + b_work_private;

    if (smoking_status === 'smokes') {
        log_odds += b_smoke_smokes;
    } else if (smoking_status === 'never smoked') {
        log_odds += b_smoke_never;
    } 

    // --- 5. RESULTADO ---
    var probabilidade = 1 / (1 + Math.exp(-log_odds));
    var porcentagem = (probabilidade * 100).toFixed(2);

    // --- 6. EXIBIR ---
    var resultadoTexto = porcentagem + "%";
    var classificacao = "";

    if (probabilidade < 0.05) {
        classificacao = "Risco Baixo (Normal)";
        document.getElementById('result').style.color = "green";
    } else if (probabilidade < 0.15) {
        classificacao = "Risco Elevado";
        document.getElementById('result').style.color = "orange";
    } else {
        classificacao = "Risco Alto - Procure um médico";
        document.getElementById('result').style.color = "red";
    }

    document.getElementById('result').innerHTML = "<strong>" + resultadoTexto + "</strong><br>" + classificacao;
}
</script>
</body>
</html>
