<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Previsão de Risco de AVC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .card {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 5px 10px -5px rgba(0, 0, 0, 0.04);
        }
        /* Estilo para focar nos selects e inputs */
        input:focus, select:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
        }
        /* Classes customizadas para o resultado */
        .risk-high { color: #dc2626; font-weight: 700; border-color: #dc2626; }
        .risk-moderate { color: #f59e0b; font-weight: 700; border-color: #f59e0b; }
        .risk-low { color: #10b981; font-weight: 700; border-color: #10b981; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800">Simulador de Risco de AVC</h1>
            <p class="text-gray-500">Avaliação baseada em fatores de saúde e estilo de vida.</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

            <!-- Painel de Input (Colunas 1 e 2) -->
            <div class="lg:col-span-2 bg-white p-6 rounded-xl card">
                <h2 class="text-xl font-semibold mb-6 text-gray-700">Dados do Paciente</h2>
                
                <form id="riskForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">

                    <!-- Gênero -->
                    <div>
                        <label for="gender" class="block text-sm font-medium text-gray-700">Gênero</label>
                        <select id="gender" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-2 transition duration-150 ease-in-out">
                            <option value="Female">Feminino</option>
                            <option value="Male">Masculino</option>
                            <option value="Other">Outro</option>
                        </select>
                    </div>

                    <!-- Idade -->
                    <div>
                        <label for="age" class="block text-sm font-medium text-gray-700">Idade</label>
                        <input type="number" id="age" value="30" min="0" max="120" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-2 transition duration-150 ease-in-out">
                    </div>

                    <!-- Hipertensão -->
                    <div>
                        <label for="hypertension" class="block text-sm font-medium text-gray-700">Hipertensão (Sim/Não)</label>
                        <select id="hypertension" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-2 transition duration-150 ease-in-out">
                            <option value="0">Não</option>
                            <option value="1">Sim</option>
                        </select>
                    </div>

                    <!-- Doença Cardíaca -->
                    <div>
                        <label for="heart_disease" class="block text-sm font-medium text-gray-700">Doença Cardíaca (Sim/Não)</label>
                        <select id="heart_disease" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-2 transition duration-150 ease-in-out">
                            <option value="0">Não</option>
                            <option value="1">Sim</option>
                        </select>
                    </div>

                    <!-- Nível de Glicose Médio -->
                    <div>
                        <label for="avg_glucose_level" class="block text-sm font-medium text-gray-700">Glicose Média (mg/dL)</label>
                        <input type="number" id="avg_glucose_level" value="90" min="50" max="300" step="0.1" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-2 transition duration-150 ease-in-out">
                    </div>

                    <!-- IMC -->
                    <div>
                        <label for="bmi" class="block text-sm font-medium text-gray-700">IMC (Índice de Massa Corporal)</label>
                        <input type="number" id="bmi" value="25" min="10" max="60" step="0.1" required class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-2 transition duration-150 ease-in-out">
                    </div>
                    
                    <!-- Status de Fumante -->
                    <div class="md:col-span-2">
                        <label for="smoking_status" class="block text-sm font-medium text-gray-700">Status de Fumante</label>
                        <select id="smoking_status" class="mt-1 block w-full rounded-lg border-gray-300 shadow-sm p-2 transition duration-150 ease-in-out">
                            <option value="never smoked">Nunca Fumou</option>
                            <option value="formerly smoked">Fumava Antes</option>
                            <option value="smokes">Fuma Atualmente</option>
                            <option value="Unknown">Desconhecido</option>
                        </select>
                    </div>

                    <div class="md:col-span-2 mt-4">
                        <button type="submit" class="w-full py-3 px-4 border border-transparent rounded-lg shadow-lg text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out">
                            Calcular Risco de AVC
                        </button>
                    </div>

                </form>
            </div>

            <!-- Painel de Resultado (Coluna 3) -->
            <div class="lg:col-span-1 bg-white p-6 rounded-xl card h-fit sticky top-8">
                <h2 class="text-xl font-semibold mb-6 text-gray-700">Probabilidade de Risco de AVC</h2>
                
                <div id="resultContainer" class="text-center p-4 border-2 border-dashed rounded-lg bg-gray-50">
                    <p class="text-lg text-gray-500 mb-2">Preencha e Calcule</p>
                    <p class="text-4xl font-extrabold text-gray-400" id="riskValue">0%</p>
                    <p class="text-xl font-bold mt-3" id="riskClassification">Aguardando Dados...</p>
                </div>

                <div class="mt-6">
                    <h3 class="font-medium text-gray-700 mb-2">Interpretação:</h3>
                    <ul class="text-sm text-gray-600 space-y-1">
                        <li><span class="inline-block w-2 h-2 rounded-full bg-red-600 mr-2"></span>**Alto Risco:** Requer atenção médica imediata e mudança de estilo de vida.</li>
                        <li><span class="inline-block w-2 h-2 rounded-full bg-yellow-500 mr-2"></span>**Risco Moderado:** Necessidade de monitoramento e consultas com especialista.</li>
                        <li><span class="inline-block w-2 h-2 rounded-full bg-green-500 mr-2"></span>**Baixo Risco:** Risco de linha de base. Recomenda-se manter hábitos saudáveis.</li>
                    </ul>
                </div>
            </div>

        </div>
    </div>

    <script>
        document.getElementById('riskForm').addEventListener('submit', function(e) {
            e.preventDefault();
            calculateRisk();
        });

        // Função principal para calcular o risco com lógica aprimorada
        function calculateRisk() {
            // 1. Obter valores dos inputs
            const age = parseFloat(document.getElementById('age').value) || 0;
            const hypertension = parseInt(document.getElementById('hypertension').value) || 0;
            const heart_disease = parseInt(document.getElementById('heart_disease').value) || 0;
            const avg_glucose_level = parseFloat(document.getElementById('avg_glucose_level').value) || 0;
            const bmi = parseFloat(document.getElementById('bmi').value) || 0;
            const smoking_status = document.getElementById('smoking_status').value;
            const gender = document.getElementById('gender').value;

            // 2. Definir pesos aprimorados (Ajustados para gerar classificações de risco mais realistas/sensíveis)
            // Estes pesos são simplificados e apenas para fins de simulação/demonstração.
            const WEIGHTS = {
                age_factor: 0.005,      // Aumenta com a idade
                hypertension: 0.20,
                heart_disease: 0.25,    // Maior peso para doença cardíaca
                glucose_factor: 0.001,  // Contribuição do nível de glicose
                bmi_factor: 0.005,      // Contribuição do IMC
                smoking_formerly: 0.10, // Risco maior se fumava antes
                smoking_current: 0.15,  // Risco mais alto se fuma atualmente
                gender_male: 0.03       // Pequena diferença para o gênero (Male)
            };

            let raw_score = 0;

            // 3. Calcular a pontuação bruta (raw_score)
            
            // Fatores Contínuos
            raw_score += age * WEIGHTS.age_factor;
            raw_score += avg_glucose_level * WEIGHTS.glucose_factor;
            raw_score += bmi * WEIGHTS.bmi_factor;

            // Fatores Binários/Categóricos
            raw_score += hypertension * WEIGHTS.hypertension;
            raw_score += heart_disease * WEIGHTS.heart_disease;

            if (gender === 'Male') {
                raw_score += WEIGHTS.gender_male;
            }

            // Status de Fumante
            if (smoking_status === 'formerly smoked') {
                raw_score += WEIGHTS.smoking_formerly;
            } else if (smoking_status === 'smokes') {
                raw_score += WEIGHTS.smoking_current;
            }

            // 4. Determinar Probabilidade e Classificação
            // Limitar a pontuação máxima para simular uma probabilidade
            const max_score = 1.0; 
            let probability = Math.min(raw_score, max_score);

            // Escalar a probabilidade para uma porcentagem
            let probability_percent = (probability * 100).toFixed(1);

            let classification = "Baixo Risco";
            let classification_class = "risk-low";

            // Definir limiares de classificação
            if (probability >= 0.45) { // Novo limiar para 'Alto Risco'
                classification = "Alto Risco";
                classification_class = "risk-high";
            } else if (probability >= 0.20) {
                classification = "Risco Moderado";
                classification_class = "risk-moderate";
            }

            // 5. Atualizar o Painel de Resultado
            const resultContainer = document.getElementById('resultContainer');
            const riskValue = document.getElementById('riskValue');
            const riskClassification = document.getElementById('riskClassification');

            // Resetar classes de cor
            resultContainer.className = 'text-center p-4 border-2 border-dashed rounded-lg bg-gray-50';
            riskClassification.className = '';

            // Aplicar novas classes e valores
            resultContainer.classList.add(`border-${classification_class.split('-')[1]}-400`);
            riskValue.textContent = `${probability_percent}%`;
            riskClassification.textContent = `Resultado: ${classification}`;
            riskClassification.classList.add(classification_class);
            riskClassification.classList.add('text-xl', 'font-bold', 'mt-3');
        }

        // Garante que o cálculo inicial seja executado na primeira vez que a página carrega
        window.onload = function() {
            calculateRisk();
        };

    </script>
</body>
</html>